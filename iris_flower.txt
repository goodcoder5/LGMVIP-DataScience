import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
from sklearn.metrics import classification_report
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score

dataset = pd.read_csv('http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data')
dataset.head()

dataset.columns

columns = ['sepal_length', 'sepal_width', 'petal_length', 'petal_width', 'class']

dataset.columns = columns
dataset.head()

dataset.isnull().sum()

sns.boxplot(data = dataset, width = 0.5, fliersize=5)
sns.set(rc = {"figure.figsize": (6, 6)})

sns.violinplot(y = 'class', x = 'sepal_length', data = dataset, inner = 'quartile')
plt.show()
sns.violinplot(y = 'class', x = 'sepal_width', data = dataset, inner = 'quartile')
plt.show()
sns.violinplot(y = 'class', x = 'petal_length', data = dataset, inner = 'quartile')
plt.show()
sns.violinplot(y = 'class', x = 'petal_width', data = dataset, inner = 'quartile')
plt.show()

x = dataset.drop(['class'], axis=1)
y = dataset['class']
print(f'x: shape: {x.shape} | y shape: {y.shape}')

model = []
model.append(('SVC', SVC(gamma = 'auto')))

model = SVC(gamma='auto')
model.fit(x_train, y_train)
y_pred = model.predict(x_test)

print(f'test accuracy: {accuracy_score(y_test, y_pred)}')
print(f'classification report: \n {classification_report(y_test, y_pred)}')